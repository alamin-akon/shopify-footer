{% schema %}
{
  "name": "Luxury Product Grid",
  "settings": [
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "NEW ARRIVALS"
    },
    {
      "type": "range",
      "id": "columns",
      "min": 2,
      "max": 5,
      "step": 1,
      "label": "Products per row (Desktop)",
      "default": 4
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "settings": [
        {
          "type": "product",
          "id": "product_ref",
          "label": "Select Product"
        },
        {
          "type": "header",
          "content": "Custom Overrides (Optional)"
        },
        {
          "type": "image_picker",
          "id": "custom_image_1",
          "label": "Custom Main Image"
        },
        {
          "type": "image_picker",
          "id": "custom_image_2",
          "label": "Custom Hover Image"
        },
        {
          "type": "text",
          "id": "custom_title",
          "label": "Custom Title",
          "info": "Leave blank to use product title"
        },
        {
          "type": "text",
          "id": "custom_subtitle",
          "label": "Material / Subtitle",
          "info": "e.g. Alpaca, Virgin Wool"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Luxury Product Grid",
      "blocks": [
        { "type": "product" },
        { "type": "product" },
        { "type": "product" },
        { "type": "product" }
      ]
    }
  ]
}
{% endschema %}

<style>
  @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;700&family=Montserrat:wght@300;400;500&display=swap');

  .hqi-grid-container-{{ section.id }} {
    background-color: #ffffff;
    padding: 60px 10%;
    font-family: 'Cinzel', serif;
    color: #000;
  }

.hqi-grid-header {
    text-align: center;
    font-size: 40px;          /* Desktop */
    letter-spacing: 0.25em;
    margin-bottom: 70px;
    font-weight: 600;
    text-transform: uppercase;
}

/* Tablet */
@media (max-width: 1024px) {
    .hqi-grid-header {
        font-size: 32px;
        letter-spacing: 0.2em;
        margin-bottom: 50px;
    }
}

/* Mobile */
@media (max-width: 768px) {
    .hqi-grid-header {
        font-size: 24px;
        letter-spacing: 0.15em;
        margin-bottom: 35px;
    }
}

/* Small mobile */
@media (max-width: 480px) {
    .hqi-grid-header {
        font-size: 20px;
        letter-spacing: 0.1em;
        margin-bottom: 25px;
    }
}


  .hqi-product-grid {
    display: grid;
    grid-template-columns: repeat({{ section.settings.columns }}, 1fr);
    gap: 15px;
    max-width: 1800px;
    margin: 0 auto;
  }

  .hqi-product-card {
    position: relative;
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* Image Area */
  .hqi-img-wrapper {
    position: relative;
    width: 100%;
    aspect-ratio: 3 / 4;
    background-color: #F8F8F6;
    overflow: hidden;
  }

  .hqi-img-wrapper img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: opacity 0.8s cubic-bezier(0.19, 1, 0.22, 1);
  }

  .hqi-hover-img {
    opacity: 0;
  }

  /* Text Info Area */
  .hqi-info-area {
    padding: 25px 0;
    text-align: center;
    background: #fff;
    transition: transform 0.6s cubic-bezier(0.19, 1, 0.22, 1), background 0.6s;
    position: relative;
    z-index: 10;
  }

  .hqi-product-title {
    font-size: 18px;
    margin-bottom: 6px;
    display: block;
    font-weight: 500;
    color: black; 
  }

.hqi-product-subtitle {
    font-family: 'Cinzel', serif;
    font-size: 14px;
    color: #444444;
    letter-spacing: 0.02em;
    display: block;
    font-weight: 400;
}

  /* HOVER EFFECTS */
  @media (min-width: 1025px) {
    .hqi-product-card:hover .hqi-main-img {
      opacity: 0;
    }
    .hqi-product-card:hover .hqi-hover-img {
      opacity: 1;
    }
    
    /* The sliding title effect: moves text from below image into image area */
    .hqi-product-card:hover .hqi-info-area {
      transform: translateY(-90px);
      background: rgba(248, 248, 246, 0.95); /* Slight transparency but matches bg */
      padding: 30px 10px;
    }
  }

  /* Mobile Responsive */
  @media (max-width: 1024px) {
    .hqi-product-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
    .hqi-grid-container-{{ section.id }} { padding: 40px 15px; }
    .hqi-info-area { padding: 15px 0; }
  }

  @media (max-width: 600px) {
    .hqi-product-grid { grid-template-columns: 1fr; }
  }
</style>

<div class="hqi-grid-container-{{ section.id }}">
  {% if section.settings.heading != blank %}
    <h2 class="hqi-grid-header">{{ section.settings.heading }}</h2>
  {% endif %}

  <div class="hqi-product-grid">
    {% for block in section.blocks %}
      {% assign prod = all_products[block.settings.product_ref] %}
      
      <a href="{{ prod.url | default: '#' }}" class="hqi-product-card" {{ block.shopify_attributes }}>
        
        <div class="hqi-img-wrapper">
          {% comment %} Main Image Logic {% endcomment %}
          {% if block.settings.custom_image_1 != blank %}
            <img class="hqi-main-img" src="{{ block.settings.custom_image_1 | image_url: width: 1000 }}" alt="{{ block.settings.custom_title }}" loading="lazy">
          {% elsif prod.featured_image != blank %}
            <img class="hqi-main-img" src="{{ prod.featured_image | image_url: width: 1000 }}" alt="{{ prod.title }}" loading="lazy">
          {% else %}
            {{ 'product-1' | placeholder_svg_tag: 'hqi-main-img' }}
          {% endif %}

          {% comment %} Hover Image Logic {% endcomment %}
          {% if block.settings.custom_image_2 != blank %}
            <img class="hqi-hover-img" src="{{ block.settings.custom_image_2 | image_url: width: 1000 }}" alt="{{ block.settings.custom_title }}" loading="lazy">
          {% elsif prod.images[1] != blank %}
            <img class="hqi-hover-img" src="{{ prod.images[1] | image_url: width: 1000 }}" alt="{{ prod.title }}" loading="lazy">
          {% endif %}
        </div>

        <div class="hqi-info-area">
          <span class="hqi-product-title">
            {{ block.settings.custom_title | default: prod.title | default: "Luxury Piece" }}
          </span>
          <span class="hqi-product-subtitle">
            {{ block.settings.custom_subtitle | default: "New Season Collection" }}
          </span>
        </div>

      </a>
    {% endfor %}
  </div>
</div>
