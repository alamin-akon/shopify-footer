{% comment %}
  Theme Section: Luxury Collection Slider (Cinzel Font)
  Description: Sidebar with sticky title and smooth slider using Cinzel Typography.
{% endcomment %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<div class="na-section-wrapper" style="background-color: {{ section.settings.bg_color }}; color: {{ section.settings.text_color }};">
  
  <div class="na-container">
    
    <div class="na-sidebar" style="border-right: 1px solid {{ section.settings.border_color }};">
      <div class="na-header">
        <span class="na-slash">/ </span>
        <h2 class="na-title">{{ section.settings.heading }}</h2>
        <span class="na-count">01</span>
      </div>

      <div class="na-controls">
        <button class="na-btn prev-btn" style="border-color: {{ section.settings.border_color }}; color: {{ section.settings.text_color }};">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        </button>
        <button class="na-btn next-btn" style="border-color: {{ section.settings.border_color }}; color: {{ section.settings.text_color }};">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
      </div>

      <div class="na-view-all">
        <a href="{{ routes.collections_url }}" class="na-link" style="color: {{ section.settings.text_color }};">ALL COLLECTIONS</a>
      </div>
    </div>

    <div class="na-slider-window">
      <div class="na-track">
        {% for block in section.blocks %}
          {% assign collection = block.settings.collection_link %}
          
          <div class="na-card" {{ block.shopify_attributes }}>
            <div class="na-image-box">
              <a href="{{ collection.url | default: '#' }}">
                {% if block.settings.custom_image != blank %}
                  <img src="{{ block.settings.custom_image | image_url: width: 800 }}" alt="{{ block.settings.custom_title }}" loading="lazy" class="na-img">
                {% elsif collection.featured_image != blank %}
                  <img src="{{ collection.featured_image | image_url: width: 800 }}" alt="{{ collection.title }}" loading="lazy" class="na-img">
                {% else %}
                  {{ 'collection-1' | placeholder_svg_tag: 'na-img placeholder' }}
                {% endif %}
              </a>
            </div>
            
            <div class="na-details" style="border-top: 1px solid {{ section.settings.border_color }};">
              <h3 class="na-product-title">
                {% if block.settings.custom_title != blank %}
                  {{ block.settings.custom_title }}
                {% else %}
                  {{ collection.title }}
                {% endif %}
              </h3>
              
              <span class="na-meta">
                {% if block.settings.item_count != blank %}
                  {{ block.settings.item_count }}
                {% elsif collection != blank %}
                  {{ collection.products_count }} ITEMS
                {% else %}
                  EXPLORE
                {% endif %}
              </span>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>

  </div>
</div>

<style>
  /* Import Cinzel Font */
  @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&family=Montserrat:wght@300;400&display=swap');

  .na-section-wrapper {
    width: 100%;
    padding: 60px 0;
    /* Use Montserrat for body text for readability */
    font-family: 'Montserrat', sans-serif; 
    border-top: 1px solid {{ section.settings.border_color }};
    border-bottom: 1px solid {{ section.settings.border_color }};
    overflow: hidden;
  }

  .na-container {
    display: grid;
    grid-template-columns: 320px 1fr;
    height: 600px;
    max-width: 1600px;
    margin: 0 auto;
    position: relative;
  }

  /* SIDEBAR */
  .na-sidebar {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 0 40px;
    position: relative;
    z-index: 2;
    background-color: {{ section.settings.bg_color }};
  }

  .na-header { margin-top: 20px; }

  .na-slash {
    font-weight: 300;
    opacity: 0.7;
    font-size: 1.2rem;
    color: #ff3b30;
  }

  /* UPDATED FONT FAMILY HERE */
  .na-title {
    font-family: 'Cinzel', serif; /* Applied Cinzel Here */
    font-size: 40;
    line-height: 1;
    text-transform: uppercase;
    margin: 10px 0;
    font-weight: 600;
    letter-spacing: 0px;
    color: white;
  }

  .na-count {
    font-family: 'Cinzel', serif; /* Applied Cinzel Here */
    font-size: 1rem;
    opacity: 0.6;
    vertical-align: super;
    margin-left: 5px;
  }

  /* CONTROLS */
  .na-controls {
    display: flex;
    gap: 15px;
  }

  .na-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: transparent;
    border: 1px solid;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .na-btn:hover {
    background: {{ section.settings.text_color }};
    color: {{ section.settings.bg_color }} !important;
    transform: scale(1.1);
  }

  .na-link {
    text-decoration: none;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    border-bottom: 1px solid transparent;
    transition: border 0.3s;
    font-weight: 600;
    font-family: 'Cinzel', serif; /* Applied Cinzel Here */
  }
  .na-link:hover { border-bottom-color: currentColor; }

  /* SLIDER AREA */
  .na-slider-window {
    overflow: hidden;
    width: 100%;
    position: relative;
    padding-left: 50px;
  }

  .na-track {
    display: flex;
    gap: 30px;
    height: 100%;
    align-items: center;
  }

  /* CARD STYLE */
  .na-card {
    min-width: 320px;
    height: 100%;
    display: flex;
    flex-direction: column;
    position: relative;
  }

  .na-image-box {
    flex-grow: 1;
    position: relative;
    overflow: hidden;
    background: #111;
  }

  .na-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  
  .na-card:hover .na-img {
    transform: scale(1.1);
  }

  .na-img.placeholder { background: #222; opacity: 0.5; }

  .na-details {
    margin-top: 20px;
    padding-top: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* UPDATED FONT FAMILY HERE */
  .na-product-title {
    font-family: 'Cinzel', serif; /* Applied Cinzel Here */
    margin: 0;
    font-size: 1.3rem;
    font-weight: 500;
    color: white;
  }

  .na-meta {
    font-size: 0.8rem;
    opacity: 0.8;
    font-family: 'Montserrat', sans-serif; /* Keep small text readable */
    letter-spacing: 1px;
  }

  /* RESPONSIVE */
  @media (max-width: 900px) {
    .na-container {
      grid-template-columns: 1fr;
      height: auto;
    }
    .na-sidebar {
      border-right: none;
      border-bottom: 1px solid {{ section.settings.border_color }};
      padding: 30px 20px;
      flex-direction: row;
      flex-wrap: wrap;
      align-items: center;
    }
    .na-header, .na-controls { margin: 0; }
    .na-view-all { display: none; }
    .na-slider-window {
      padding: 30px 20px;
      min-height: 450px;
    }
    .na-card { min-width: 260px; }
  }
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const track = document.querySelector('.na-track');
  const nextBtn = document.querySelector('.na-btn.next-btn');
  const prevBtn = document.querySelector('.na-btn.prev-btn');

  // GSAP Configuration
  const cardWidth = 320; // Match CSS min-width
  const gap = 30; // Match CSS gap
  const totalMove = cardWidth + gap;
  
  let currentPos = 0;

  function updateSlider() {
    gsap.to(track, {
      x: currentPos,
      duration: {{ section.settings.anim_speed }},
      ease: "power2.out"
    });
  }

  nextBtn.addEventListener('click', () => {
    const windowWidth = document.querySelector('.na-slider-window').offsetWidth;
    const trackWidth = track.scrollWidth;
    const maxScroll = -(trackWidth - windowWidth);

    if (currentPos > maxScroll) {
      currentPos -= totalMove;
      updateSlider();
    } else {
      gsap.to(track, { x: currentPos - 20, yoyo: true, repeat: 1, duration: 0.1 });
    }
  });

  prevBtn.addEventListener('click', () => {
    if (currentPos < 0) {
      currentPos += totalMove;
      updateSlider();
    } else {
       gsap.to(track, { x: 20, yoyo: true, repeat: 1, duration: 0.1 });
    }
  });
});
</script>

{% schema %}
{
  "name": "Luxury Collection Grid",
  "settings": [
    {
      "type": "header",
      "content": "Section Design"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#0e0e0e"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border Color",
      "default": "#333333"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Sidebar Title",
      "default": "COLLECTIONS"
    },
    {
      "type": "range",
      "id": "anim_speed",
      "min": 0.5,
      "max": 3.0,
      "step": 0.1,
      "label": "Animation Speed",
      "default": 1.2
    }
  ],
  "blocks": [
    {
      "type": "collection_block",
      "name": "Collection Block",
      "settings": [
        {
          "type": "image_picker",
          "id": "custom_image",
          "label": "Custom Image (Manual)"
        },
        {
          "type": "text",
          "id": "custom_title",
          "label": "Custom Title (Optional)",
          "info": "Leave blank to use Collection title"
        },
        {
          "type": "text",
          "id": "item_count",
          "label": "Custom Count (Optional)",
          "placeholder": "12 ITEMS"
        },
        {
          "type": "collection",
          "id": "collection_link",
          "label": "Link to Collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Luxury Collection Grid",
      "blocks": [
        { "type": "collection_block" },
        { "type": "collection_block" },
        { "type": "collection_block" }
      ]
    }
  ]
}
{% endschema %}