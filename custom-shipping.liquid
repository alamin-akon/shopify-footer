{% schema %}
{
  "name": "Service USPs",
  "settings": [
    {
      "type": "header",
      "content": "Section Title"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "At your service"
    },
    {
      "type": "header",
      "content": "Aesthetics"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background",
      "default": "#ffffff"
    }
  ],
  "blocks": [
    {
      "type": "service",
      "name": "Service Item",
      "limit": 3,
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Illustration/Icon"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Free Shipping"
        },
        {
          "type": "text",
          "id": "link_text",
          "label": "Link Text",
          "default": "Discover More"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Link URL"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Service USPs",
      "blocks": [
        { "type": "service" },
        { "type": "service" },
        { "type": "service" }
      ]
    }
  ]
}
{% endschema %}

<style>
  @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;700&family=Montserrat:wght@300;400;500;600&display=swap');

  .hqi-service-{{ section.id }} {
    background-color: {{ section.settings.bg_color }};
    padding: 60px 4%;
    font-family: 'Cinzel', serif;
    color: #000;
    overflow: hidden;
  }

  .hqi-service-heading {
    text-align: center;
    font-size: 40px;
    letter-spacing: 0.15em;
    margin-bottom: 80px;
    text-transform: none;
    font-weight: 500;
  }

  .hqi-service-grid {
    display: flex;
    max-width: 1600px;
    margin: 0 auto;
    justify-content: space-between;
    gap: 0;
  }

  .hqi-service-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 20px 40px;
    position: relative;
    text-decoration: none;
    color: inherit;
  }

  /* Vertical Dividers */
  .hqi-service-item:not(:last-child)::after {
    content: '';
    position: absolute;
    right: 0;
    top: 20%;
    height: 60%;
    width: 1px;
    background-color: #e0e0e0;
  }

  .hqi-service-icon-box {
    width: 100%;
    max-width: 160px;
    aspect-ratio: 1.5/1;
    margin-bottom: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .hqi-service-icon-box img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    transition: transform 0.8s cubic-bezier(0.19, 1, 0.22, 1);
  }

  .hqi-service-item:hover img {
    transform: translateY(-10px);
  }

.hqi-service-title {
    font-family: 'Cinzel', serif;
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 30px;
    color: #333;
    line-height: 1.6;
    max-width: 100%;
}

.hqi-service-link {
    font-family: 'Cinzel', serif;
    font-size: 14px;
    color: #484848;
    letter-spacing: 0.05em;
    font-weight: 400;
    position: relative;
}

  .hqi-service-link::before,
  .hqi-service-link::after {
    content: 'â€”';
    margin: 0 10px;
    opacity: 0.6;
  }

  /* Responsive Fixes */
  @media (max-width: 1024px) {
    .hqi-service-grid { flex-direction: column; }
    .hqi-service-item:not(:last-child)::after {
      right: 20%;
      top: auto;
      bottom: 0;
      height: 1px;
      width: 60%;
      left: 20%;
    }
    .hqi-service-item { padding: 60px 20px; }
  }
</style>

<div class="hqi-service-{{ section.id }}" id="ServiceSection-{{ section.id }}">
  {% if section.settings.heading != blank %}
    <h2 class="hqi-service-heading">{{ section.settings.heading }}</h2>
  {% endif %}

  <div class="hqi-service-grid">
    {% for block in section.blocks %}
      <a href="{{ block.settings.link_url | default: '#' }}" class="hqi-service-item" {{ block.shopify_attributes }}>
        <div class="hqi-service-icon-box">
          {% if block.settings.icon != blank %}
            <img src="{{ block.settings.icon | image_url: width: 400 }}" alt="{{ block.settings.title }}" loading="lazy">
          {% else %}
             {{ 'image' | placeholder_svg_tag: 'hqi-placeholder' }}
          {% endif %}
        </div>
        
        <span class="hqi-service-title">{{ block.settings.title }}</span>
        
        {% if block.settings.link_text != blank %}
          <span class="hqi-service-link">{{ block.settings.link_text }}</span>
        {% endif %}
      </a>
    {% endfor %}
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

<script>
  (function() {
    if (typeof gsap === 'undefined') return;
    gsap.registerPlugin(ScrollTrigger);

    const section = document.getElementById('ServiceSection-{{ section.id }}');
    const heading = section.querySelector('.hqi-service-heading');
    const items = section.querySelectorAll('.hqi-service-item');

    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: section,
        start: "top 85%",
      }
    });

    if (heading) {
      tl.from(heading, { y: 30, opacity: 0, duration: 1, ease: "power2.out" });
    }

    tl.from(items, {
      y: 50,
      opacity: 0,
      duration: 1.2,
      stagger: 0.2,
      ease: "power3.out"
    }, "-=0.5");
  })();
</script>
